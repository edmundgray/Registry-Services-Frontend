<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="../CSS/style.css">
        
        <!-- Add authManager.js for global AuthManager and AUTH_CONFIG -->
        <script src="../JS/auth/authManager.js"></script>
        <script>
            // Create a global authManager instance
            window.authManager = new AuthManager();
            // Define authenticatedFetch globally
            function authenticatedFetch(url, options = {}) {
                const headers = { ...(options.headers || {}), ...window.authManager.getAuthHeaders() };
                return fetch(url, { ...options, headers });
            }
        </script>
        <script src="../JS/sidebarManager.js"></script>
        <script src="../JS/javascript.js"></script>
        <script src="../JS/coreInvoiceModel.js"></script>
        
        <title>Registry Services</title>
        
        <style>
            .page-Content 
            {
                font-size: 0.9em;
            }
            .styled-table th,
            .styled-table td 
            {
                padding: 10.8px 13.5px;
                font-size: 0.9em;
            }
            .styled-table thead tr 
            {
                font-size: 1.2em;
            }
            .fa-solid 
            {
                font-size: 1.2em;
            }
            .show-more-btn 
            {
                font-size: 0.95em !important;
                padding: 4px 12px !important;
            }
            .table-container 
            {
                font-size: 0.9em;
            }
            .centered-cell {
                text-align: center;
            }
        </style>
    </head>
    <body>
<!----------------------------------------------------------------------------
        Sidebar
  ------------------------------------------------------------------------------>
        <div id="sidebarContainer">
            <!-- Sidebar will be dynamically generated by sidebarManager.js -->
        </div>

<!----------------------------------------------------------------------------
        Main Content
  ------------------------------------------------------------------------------>
        <div class="page-Content">
            <h1>
                <i class="fa-solid fa-car"></i> Core Invoice Model
                <span style="color: #b22222; font-size: 0.6em; margin-left: 12px; vertical-align: middle;">(READ-ONLY)</span>
            </h1>

            <div class="table-container">
                <table id="coreInvoiceTable" class="styled-table">
                    <thead>                        <tr>
                            <th>ID</th>
                            <th>Level</th>
                            <th>Cardinality</th>
                            <th>Business Term</th>
                            <th>Usage Note</th>
                            <th>Business Rules</th>
                            <th>Data Type</th>
                            <th>Actions</th>
                        </tr>
                    </thead>                    <tbody>
                        <!-- Rows will be populated by JavaScript in coreInvoiceModel.js -->
                    </tbody>
                </table>
            </div>
            <div style="display: flex; justify-content: center; margin-top: 30px;">
                <button type="button" onclick="handleReadOnlyCancel()" class="view-button" style="background-color: #F4A261; color: #fff;">Cancel</button>
            </div>
        </div>
        
        <script>
            window.coreInvoiceReadOnly = true;
            window.isCoreInvoiceReadOnly = true;

        function handleReadOnlyCancel() {
            // Navigate back without confirmation since this is read-only mode
            window.history.back();
        }

        // Add this after the sidebar <ul> is rendered
document.addEventListener("DOMContentLoaded", function() {
    if (localStorage.getItem("userRole") === "Admin") {
        const sidebar = document.querySelector(".sidebar ul");
        if (sidebar) {
            const li = document.createElement("li");
            li.className = "child-element protected";
            li.innerHTML = `
                <a href="ExtensionComponentDataModelAdmin.html">
                    <span class="icon"><i class="fa-solid fa-eye"></i></span>
                    <span class="text">VIEW EXTENSION COMPONENT DATA MODEL (ADMIN)</span>
                </a>
            `;
            sidebar.appendChild(li);
        }
    }
});

// Make all checkboxes and dropdowns disabled on page load (in case any are rendered dynamically)
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.disabled = true);
        document.querySelectorAll('select').forEach(sel => sel.disabled = true);
        document.querySelectorAll('input[type="text"], input[type="number"], textarea').forEach(inp => inp.readOnly = true);
    });

    function makeCoreInvoiceModelReadOnly() {
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.disabled = true);
        document.querySelectorAll('select').forEach(sel => sel.disabled = true);
        document.querySelectorAll('input[type="text"], input[type="number"], textarea').forEach(inp => inp.readOnly = true);
    }

    // Run after everything is rendered (including coreInvoiceModel.js)
    document.addEventListener("DOMContentLoaded", function() {
        setTimeout(makeCoreInvoiceModelReadOnly, 100); // 100ms delay to ensure all rows are rendered
    });
        </script>
        
        <script>
            // Initialize the sidebar and authentication when the page loads
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize auth manager
                window.authManager.init();
                
                // Initialize sidebar
                window.sidebarManager.initializeSidebar(window.authManager);
            });
        </script>
    </body>
</html>