<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="../CSS/style.css">
        
        <!-- Add authManager.js for global AuthManager and AUTH_CONFIG -->
        <script src="../JS/auth/authManager.js"></script>
        <script>
            // Create a global authManager instance
            window.authManager = new AuthManager();
            // Define authenticatedFetch globally
            function authenticatedFetch(url, options = {}) {
                const headers = { ...(options.headers || {}), ...window.authManager.getAuthHeaders() };
                return fetch(url, { ...options, headers });
            }
        </script>
        <script src="../JS/sidebarManager.js"></script>
        <script src="../JS/dataManager.js"></script>
        <script src="../JS/javascript.js"></script>
        <script src="../JS/governingEntity.js"></script>
        
        <title>Governing Entities</title>
    </head>
    <body>
<!----------------------------------------------------------------------------
            Sidebar
  ------------------------------------------------------------------------------>
        <div id="sidebarContainer">
            <!-- Sidebar will be dynamically generated by sidebarManager.js -->
        </div>

<!----------------------------------------------------------------------------
            Governing Entities Table
  ------------------------------------------------------------------------------>
        <div class="page-Content">
            <h1 id="entityTitle"><i class="fa-solid fa-building"></i> Viewing Governing Entity</h1>
            <br/>
            <button onclick="window.location.href='governingEntityList.html';">Return to Governing Entity List</button>

            
            <div id="entityDetails"></div>
            <h2 style="margin: 0;font-size:20px;">Specifications</h2>
            <div id="adminNewSpecContainer" style="text-align: right; margin-bottom: 0;"></div>
            <div id="specificationsSection"></div>
            <div id="usersSection"></div>
            
        </div>
        
        <script>
            // The governing entity functionality is now handled by governingEntity.js
            // This script will automatically initialize the appropriate class based on the current page
            console.log('GoverningEntityView page loaded');
            
            // Make startEdit function available globally for backward compatibility
            function startEdit(event) {
                if (window.governingEntityView) {
                    const button = event.target;
                    const specName = button.getAttribute('data-spec-name');
                    const specParams = button.getAttribute('data-spec-params');
                    window.governingEntityView.startEdit(specName, specParams);
                } else {
                    console.error('GoverningEntityView instance not found');
                }
            }
        </script>
        
        <script>
            // Initialize the sidebar and authentication when the page loads
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize auth manager
                window.authManager.init();
                
                // Initialize sidebar
                window.sidebarManager.initializeSidebar(window.authManager);
            });
        </script>
    </body>
</html>