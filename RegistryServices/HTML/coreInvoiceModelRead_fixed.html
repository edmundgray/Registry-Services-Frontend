<html></html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="../CSS/style.css">
        
        <!-- Add authManager.js for global AuthManager and AUTH_CONFIG -->
        <script src="../JS/auth/authManager.js"></script>
        <script>
            // Create a global authManager instance
            window.authManager = new AuthManager();
            // Define authenticatedFetch globally
            function authenticatedFetch(url, options = {}) {
                const headers = { ...(options.headers || {}), ...window.authManager.getAuthHeaders() };
                return fetch(url, { ...options, headers });
            }
        </script>
        <script src="../JS/sidebarManager.js"></script>
        <script src="../JS/javascript.js"></script>
        <script src="../JS/coreInvoiceModel.js"></script>
        
        <title>Registry Services</title>
        
        <style>
            .page-Content 
            {
                font-size: 0.9em;
            }
            .styled-table th,
            .styled-table td 
            {
                padding: 10.8px 13.5px;
                font-size: 0.9em;
            }
            .styled-table thead tr 
            {
                font-size: 1.2em;
            }
            .fa-solid 
            {
                font-size: 1.2em;
            }
            .show-more-btn 
            {
                font-size: 0.95em !important;
                padding: 4px 12px !important;
            }
            .table-container 
            {
                max-height: 70vh;
                overflow-y: auto;
                border: 1px solid #ccc;
                border-radius: 8px;
                margin: 10px 0;
            }
            
            /* Core Invoice Model Table Column Width Restrictions */
            #coreInvoiceTable {
                table-layout: fixed;
                width: 100%;
            }
            
            #coreInvoiceTable th:nth-child(1), /* Select */
            #coreInvoiceTable td:nth-child(1) {
                width: 50px;
                max-width: 50px;
                text-align: center;
            }
            
            #coreInvoiceTable th:nth-child(2), /* Card */
            #coreInvoiceTable td:nth-child(2) {
                width: 60px;
                max-width: 60px;
            }
            
            #coreInvoiceTable th:nth-child(3), /* Semantic Identifier */
            #coreInvoiceTable td:nth-child(3) {
                width: 100px;
                max-width: 100px;
            }
            
            #coreInvoiceTable th:nth-child(4), /* Component Type */
            #coreInvoiceTable td:nth-child(4) {
                width: 90px;
                max-width: 90px;
            }
            
            #coreInvoiceTable th:nth-child(5), /* Object Class Term */
            #coreInvoiceTable td:nth-child(5) {
                width: 150px;
                max-width: 150px;
                word-wrap: break-word;
                white-space: normal;
            }
            
            #coreInvoiceTable th:nth-child(6), /* Property Term */
            #coreInvoiceTable td:nth-child(6) {
                width: 150px;
                max-width: 150px;
                word-wrap: break-word;
                white-space: normal;
            }
            
            #coreInvoiceTable th:nth-child(7), /* Representation Term */
            #coreInvoiceTable td:nth-child(7) {
                width: 120px;
                max-width: 120px;
            }
            
            #coreInvoiceTable th:nth-child(8), /* Data Type */
            #coreInvoiceTable td:nth-child(8) {
                width: 100px;
                max-width: 100px;
            }
            
            #coreInvoiceTable th:nth-child(9), /* Associated Object Class */
            #coreInvoiceTable td:nth-child(9) {
                width: 150px;
                max-width: 150px;
                word-wrap: break-word;
                white-space: normal;
            }
            
            #coreInvoiceTable th:nth-child(10), /* Business Rules */
            #coreInvoiceTable td:nth-child(10) {
                width: 100px;
                max-width: 100px;
                word-wrap: break-word;
                white-space: normal;
            }
            
            #coreInvoiceTable th:nth-child(11), /* Definition */
            #coreInvoiceTable td:nth-child(11) {
                width: 250px;
                max-width: 250px;
                word-wrap: break-word;
                white-space: normal;
            }
            
            #coreInvoiceTable th:nth-child(12), /* Usage Rule */
            #coreInvoiceTable td:nth-child(12) {
                width: 250px;
                max-width: 250px;
                word-wrap: break-word;
                white-space: normal;
            }
            
            #coreInvoiceTable th:nth-child(13), /* Actions */
            #coreInvoiceTable td:nth-child(13) {
                width: 120px;
                max-width: 120px;
                text-align: center;
            }
        </style>
    </head>
    <body>
<!----------------------------------------------------------------------------
        Sidebar
  ------------------------------------------------------------------------------>
        <div id="sidebarContainer">
            <!-- Sidebar will be dynamically generated by sidebarManager.js -->
        </div>

<!----------------------------------------------------------------------------
        Main Content
  ------------------------------------------------------------------------------>
        <div class="page-Content">
            <h1><i class="fa-solid fa-car"></i> Core Invoice Model</h1>

            <div class="table-container">
                <table id="coreInvoiceTable" class="styled-table">
                    <thead>
                        <tr>
                            <th>Select</th>
                            <th>Card</th>
                            <th>Semantic Identifier</th>
                            <th>Component Type</th>
                            <th>Object Class Term</th>
                            <th>Property Term</th>
                            <th>Representation Term</th>
                            <th>Data Type</th>
                            <th>Associated Object Class</th>
                            <th>Business Rules</th>
                            <th>Definition</th>
                            <th>Usage Rule</th>
                            <th>
                                Actions
                                <button type="button" onclick="toggleSelectAll()" id="selectAllBtn" class="show-more-btn">
                                    Select All
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Table content will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="button-row">
                <div class="button-group">
                    <button onclick="showSelectedElements()">Show Selected Elements</button>
                    <button onclick="hideSelectedElements()">Hide Selected Elements</button>
                    <button onclick="clearAll()">Clear All</button>
                </div>
                
                <button class="spec-preview-btn" onclick="goToSpecificationPreview()">Specification Preview</button>
            </div>
            
            <!-- Modal for element details -->
            <div id="elementModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="modalTitle">Element Details</h2>
                        <span class="close" onclick="closeModal()">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div id="modalContent">
                            <!-- Content will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Initialize table and other functionality when page loads
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize auth manager
                window.authManager.init();
                
                // Initialize sidebar
                window.sidebarManager.initializeSidebar(window.authManager);
                
                // Initialize the core invoice model table
                if (typeof window.coreInvoiceModel !== 'undefined') {
                    window.coreInvoiceModel.loadTable();
                }
            });

            // Modal functions
            function openModal(title, content) {
                document.getElementById('modalTitle').textContent = title;
                document.getElementById('modalContent').innerHTML = content;
                document.getElementById('elementModal').style.display = 'block';
            }

            function closeModal() {
                document.getElementById('elementModal').style.display = 'none';
            }

            // Close modal when clicking outside of it
            window.onclick = function(event) {
                const modal = document.getElementById('elementModal');
                if (event.target === modal) {
                    closeModal();
                }
            }

            // Button functions that will be used by the table
            function toggleSelectAll() {
                if (typeof window.coreInvoiceModel !== 'undefined') {
                    window.coreInvoiceModel.toggleSelectAll();
                }
            }

            function showSelectedElements() {
                if (typeof window.coreInvoiceModel !== 'undefined') {
                    window.coreInvoiceModel.showSelectedElements();
                }
            }

            function hideSelectedElements() {
                if (typeof window.coreInvoiceModel !== 'undefined') {
                    window.coreInvoiceModel.hideSelectedElements();
                }
            }

            function clearAll() {
                if (typeof window.coreInvoiceModel !== 'undefined') {
                    window.coreInvoiceModel.clearAll();
                }
            }

            function goToSpecificationPreview() {
                window.location.href = 'specificationPreview.html';
            }
        </script>
    </body>
</html>
